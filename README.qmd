## What this repository does

We use historical OpenStreetMap (OSM) data to extract and classify street networks for a city.  
Using **Montr√©al** as an example, the workflow has two main parts:

1. **Full street network classified by `highway` type**

   We download the **full street network** for the city and classify each link into four simple groups using only the OSM `highway` tag:

   - **cycling**: `highway = cycleway`
   - **pedestrian**: `highway = pedestrian`
   - **living street**: `highway = living_street`
   - **others**: all remaining `highway` types

   This gives a broad overview of the street network.  
   At this stage we do not include on-road cycling lanes or tracks  
   (for example `cycleway = lane` or `cycleway = track` on other road types).

2. **Cycling network by infrastructure type**

   From the OSM data we then build a **broader cycling network**, where links are classified by type of cycling infrastructure  
   (for example protected tracks, painted lanes, mixed traffic).

   We implement this in two alternative ways:

   - **From scratch with `osmextract`**: custom filters based on `highway`, `cycleway*`, `bicycle*`, `segregated`, etc.  
   - **Using `osmactive`**: a higher level interface that applies a built-in cycling filter.

The scripts are written so that you can run this workflow for **one city at a time** by adjusting the city settings in `R/00_setup.R`.

::: {.callout-tip collapse=true}
## Changing city

To switch city:

1. Set the city in `R/00_setup.R`.  
   For example, for **Paris**:

 ```
 city_name           <- "Paris"
 city_tag            <- "paris"
 city_boundary_place <- "Paris, France"

 infra_region_2017 <- "Ile-de-France"  # Geofabrik region for 170101
 infra_region_2024 <- "Ile-de-France"  # This region may change by year 
```

2. Then, in a fresh R session, run:

```
source("R/00_setup.R")
source("R/01_get_boundary.R")
source("R/02_get_infrastructure.R")

build_city_boundary()
get_osm_infrastructure()
```
:::

```{r}
#| include: false
source("R/00_setup.R")
source("R/01_get_boundary.R")
source("R/02_get_infrastructure.R")
source("R/03_classify_network.R")
source("R/04_city_map.R")
```

```{r}
#| eval: false
#| include: false
build_city_boundary()       # from 01
get_osm_infrastructure()    # from 02
```

```{r}
#| label: map-panels
#| echo: false
#| message: false
#| warning: false
plot_city_panel()
```